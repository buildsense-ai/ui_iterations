# 工程AI助手前端需求文档

## 版本历史
- v1.0: 初始需求整理
- v1.1: 基于v1版本的深化需求
- v1.2: 新增AI思考过程展示功能

## 核心功能需求

### 1. 整体布局
- **基础布局**: 双栏布局（左侧文件树 + 右侧对话界面）
- **可收缩边框**: 左右侧边框可以收缩进去，节省空间
- **响应式设计**: 适配不同屏幕尺寸

### 2. 对话交互
- **初始提示**: 对话开始时提供提示prompt选择，帮助用户快速开始
- **清理界面**: 开始对话后，提示选择消失，界面专注于对话
- **移除快速操作**: 去掉输入框下面的快速操作按钮（原有的"生成施工方案"等）

### 3. 文件上传系统（双重机制）

#### 3.1 持久化知识库上传（左侧）
- **位置**: 左侧文件树区域
- **功能**: 完整的文件识知识库化持久化储存pipeline
- **处理流程**: 上传 → 解析 → 分类 → 存储到对应目录 → 向量化 → 持久化
- **显示方式**: 按工程归档目录结构显示

#### 3.2 临时对话上传（右侧）
- **位置**: 右侧对话输入框附近
- **功能**: 仅用于当前对话的文件/图片上传
- **处理流程**: 上传 → 临时处理 → 在当前对话中使用
- **支持格式**: 图片、文档等

### 4. 当前对话文件管理
- **文件清单**: 显示当前对话中上传的和AI生成的文件
- **持久化选项**: 可以点击文件进行持久化pipeline处理
- **临时存储**: 对话结束前保持可访问状态

### 5. 文件目录结构
- **施工图纸**: 建筑平面图、结构施工图、电气系统图等
- **合同文件**: 施工合同、监理合同等
- **规范标准**: 各类工程规范和标准文件
- **生成文档**: AI生成的各类工程文档
- **其他**: 未分类文件的默认存放位置

### 6. AI功能特性
- **多源检索**: 基于项目资料库 + 法律规范库回答问题
- **引用显示**: 答案后附带引用的条款原文和超链接
- **PDF查看**: 点击引用链接可在dashboard打开原文
- **文档生成**: 生成的文档自动归档到相应目录
- **思考过程展示**: 实时显示AI的思考过程和推理步骤

### 7. AI思考过程展示系统
- **实时思考展示**: AI处理问题时，实时显示思考步骤和推理过程
- **动态更新**: 思考过程以流式方式逐步展示，增强用户体验
- **自动隐藏**: 思考完成并开始最终输出时，思考过程自动折叠隐藏
- **可展开查看**: 用户可以点击展开查看完整的思考过程
- **思考步骤分类**: 
  - 问题分析阶段
  - 知识检索阶段
  - 推理整合阶段
  - 答案生成阶段
- **进度指示**: 显示当前思考进度和剩余步骤
- **思考时间**: 显示每个思考步骤的耗时
- **透明度增强**: 让用户了解AI的决策过程，增强信任感

### 8. 用户体验优化
- **无缝上传**: 支持拖拽上传文件
- **智能分类**: 自动识别文件类型并分类存储
- **实时状态**: 显示文件处理进度和系统状态
- **清晰导航**: 明确区分持久化存储和临时使用

## 技术架构相关

### 后端Pipeline（用户不可见）
- **文件解析**: 多格式文件内容提取
- **智能分类**: 基于文件内容自动分类
- **向量化处理**: 文件内容向量化存储
- **知识图谱**: 构建项目知识关系网络

### 前端交互
- **实时通信**: WebSocket连接保持对话实时性
- **文件预览**: 支持常见文件格式的预览
- **进度反馈**: 文件上传和处理进度显示
- **错误处理**: 友好的错误提示和重试机制

## 待确认需求
- [ ] 当前对话文件清单的具体展示位置和样式
- [ ] 左右侧边框收缩的触发方式（按钮/手势）
- [ ] 持久化处理的用户确认流程
- [ ] 临时文件的保存时限设置
- [ ] AI思考过程展示的具体样式和动画效果
- [ ] 思考过程自动隐藏的触发时机和条件
- [ ] 思考过程展开/收缩的交互方式
- [ ] 思考步骤的颜色编码和视觉区分 